// Logic for the global map