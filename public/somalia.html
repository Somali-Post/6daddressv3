<!-- 6D Loading Overlay (no stray text) -->
<div id="sixd-loading" role="status" aria-label="Loading 6D Somalia">
  <div class="sixd-wrap">
    <span class="sixd-spinner"><span></span></span>
    <div class="sixd-text">
      Loading&nbsp;6D&nbsp;Somalia
      <span class="sixd-dots" aria-hidden="true">
        <span class="sixd-dot sixd-red">.</span>
        <span class="sixd-dot sixd-green">.</span>
        <span class="sixd-dot sixd-blue">.</span>
      </span>
    </div>
  </div>
</div>

<!-- Sidebar Dashboard Content (injected when logged in) -->
  <!-- The dashboard will be rendered inside the sidebar__scroll when logged in and Dashboard is selected -->
  <!-- Authentication Modal (Login/OTP) -->
  <div id="auth-modal-overlay" class="modal-overlay" tabindex="-1" aria-hidden="true"></div>
  <div id="auth-modal" class="auth-modal" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title" style="display:none;">
    <button id="auth-modal-close" class="modal-close" aria-label="Close authentication dialog">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M18 6L6 18" stroke="#888" stroke-width="2" stroke-linecap="round"/>
        <path d="M6 6L18 18" stroke="#888" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
    <div id="auth-modal-content">
      <!-- Login Step (default) -->
      <div id="auth-step-login" class="auth-step">
        <h2 id="auth-modal-title">Login to Your Account</h2>
        <form id="login-form" autocomplete="off">
          <label for="login-phone">Phone Number</label>
          <div class="input-group">
            <span class="input-group-addon">+252</span>
            <input id="login-phone" name="phone" type="tel" pattern="[0-9]{9}" maxlength="9" required autocomplete="tel" placeholder="61xxxxxxxx" />
          </div>
          <button type="submit" class="btn btn--primary" id="send-otp-btn">Send Verification Code</button>
        </form>
        <div class="auth-modal-footer">
          <a href="#" id="switch-to-register">Don't have an account? Register now.</a>
        </div>
      </div>
      <!-- OTP Step (hidden by default) -->
      <div id="auth-step-otp" class="auth-step" style="display:none;">
        <h2>Enter Your Code</h2>
        <div id="otp-message">We've sent a 6-digit code to <span id="otp-phone-display">+252 XXXXXXXX</span>.</div>
        <form id="otp-form" autocomplete="off">
          <label for="otp-input">Verification Code</label>
          <div class="otp-input-group">
            <input id="otp-input" name="otp" type="text" inputmode="numeric" pattern="[0-9]{6}" maxlength="6" required autocomplete="one-time-code" />
          </div>
          <button type="submit" class="btn btn--primary" id="verify-otp-btn">Verify & Login</button>
        </form>
        <div class="auth-modal-footer">
          <button id="resend-otp-btn" class="btn btn--primary btn--small" type="button" disabled>Resend Code <span id="resend-timer">60</span>s</button>
        </div>
      </div>
      <!-- Error Message -->
      <div id="auth-error" class="auth-error" role="alert" style="display:none;"></div>
    </div>
  </div>
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- === START FAVICON CODE === -->
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="manifest" href="/site.webmanifest">
  <!-- === END FAVICON CODE === -->
  <!-- === START FAVICON AND APP ICON CODE === -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="msapplication-TileColor" content="#0d1a2e">
  <meta name="theme-color" content="#0d1a2e">
  <!-- === END FAVICON AND APP ICON CODE === -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>6D Address â€” Somalia</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/css/somalia-map.css" />
</head>
<body>
  <!-- Map canvas -->
  <div id="map"></div>

  <!-- Floating brand plaque -->
  <div id="logo-container">
  <img src="assets/logo-somalia.png" alt="6D Address Somalia" class="logo-light" />
  <img src="assets/logo-somalia-dark.png" alt="6D Address Somalia" class="logo-dark" />
  </div>

  <!-- Sidebar -->
  <div id="sidebar" class="sidebar collapsed" aria-expanded="false">
    <div class="sidebar__header">
      <button id="sidebarToggle" class="sidebar__toggle" aria-label="Toggle sidebar">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <div class="sidebar__title link-text">6D Address Somalia</div>
    </div>


    <div class="sidebar__scroll">
      <div class="sidebar__section-heading">Get Started</div>
      <nav class="sidebar__nav" aria-label="Get Started">
        <a class="sidebar__link active" href="#">
          <span class="sidebar__icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99c.41.41 1.09.41 1.5 0s.41-1.09 0-1.5l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"/>
            </svg>
          </span>
          <span class="link-text">Register Your Address</span>
        </a>
        <a class="sidebar__link" href="#">
          <span class="sidebar__icon">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <rect x="2" y="7" width="9" height="10" rx="2" class="login-icon-main"/>
              <path d="M13 12h7m0 0l-3-3m3 3l-3 3" stroke="#39363a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          <span class="link-text">Login</span>
        </a>
      </nav>

      <div class="sidebar__section-heading">Explore</div>
      <nav class="sidebar__nav" aria-label="Explore">
        <a class="sidebar__link" href="/index.html">
          <span class="sidebar__icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 2a10 10 0 100 20 10 10 0 000-20Zm0 0c3 3 3 15 0 20m0-20C9 5 9 19 12 22M2 12h20M4 7h16M4 17h16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </span>
          <span class="link-text">Global Map</span>
        </a>
        <a class="sidebar__link" href="#">
          <span class="sidebar__icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.5"/>
              <path d="M12 7v6m0 4h.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </span>
          <span class="link-text">About Us</span>
        </a>
        <a class="sidebar__link" href="#">
          <span class="sidebar__icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M4 6h16v12H4z" stroke="currentColor" stroke-width="1.5" />
              <path d="M4 7l8 6 8-6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
            </svg>
          </span>
          <span class="link-text">Contact Us</span>
        </a>
      </nav>

      <div class="sidebar__section-heading">Settings</div>
      <div class="sidebar__utility">
        <a class="sidebar__link" href="#">
          <span class="sidebar__icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 15a3 3 0 100-6 3 3 0 000 6z" stroke="currentColor" stroke-width="1.5"/>
              <path d="M19.4 15a1.5 1.5 0 010-1.9l1.7-2.9-1.7-2.9a1.5 1.5 0 01.6-2l-2.8-1.6a1.5 1.5 0 01-2 .6L12 2.6l-2.9 1.7a1.5 1.5 0 01-2-.6L4.3 5.6a1.5 1.5 0 01.6 2L3.2 10.5l1.7 2.9a1.5 1.5 0 010 1.9l-1.7 2.9 2.9 1.7a1.5 1.5 0 012-.6L12 21.4l2.9-1.7a1.5 1.5 0 012 .6l2.8-1.6a1.5 1.5 0 01-.6-2L21.1 12l-1.7-2.9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </span>
          <span class="link-text">Settings</span>
        </a>

        <label class="sidebar__link sidebar__link--toggle switch">
          <input id="themeToggle" type="checkbox" aria-label="Toggle light mode" />
          <span class="slider" aria-hidden="true"></span>
          <span class="switch__label link-text">Light/Dark Mode</span>
        </label>
      </div>

      <!-- Registration view -->
      <section id="view-register" class="sidebar-view">
        <form id="registerForm">
          <div class="field">
            <label for="code">6D Code</label>
            <div id="register-code-plaque" class="register-code-plaque">
              <span id="register-code-part-1" class="register-code-part register-code-red">44</span>
              <span class="register-code-dash">-</span>
              <span id="register-code-part-2" class="register-code-part register-code-green">06</span>
              <span class="register-code-dash">-</span>
              <span id="register-code-part-3" class="register-code-part register-code-blue">33</span>
            </div>
            <input id="code" type="hidden" />
          </div>
          <div class="field">
            <label for="name">Name</label>
            <input id="name" type="text" autocomplete="name" />
          </div>
          <div class="field">
            <label for="phone">Phone Number</label>
            <div class="input-group">
              <span class="input-group-addon">+252</span>
              <input id="phone" type="tel" autocomplete="tel" class="input-group-field" placeholder="61xxxxxxxx" maxlength="9" pattern="[0-9]{9}" />
            </div>
          </div>
          <div class="field">
            <label for="region">Region</label>
            <select id="region"></select>
          </div>
          <div class="field">
            <label for="district">District</label>
            <select id="district"></select>
          </div>
          <button type="submit" class="btn btn--primary">Submit</button>
        </form>
      </section>
    </div>
  </div>


  <!-- GPS Accuracy Info Panel (bottom left) -->
  <div id="gps-accuracy-panel" class="floating-card gps-accuracy-panel" style="display:none;">
    <span id="gps-accuracy-message">GPS accuracy: --</span>
    <button id="gps-accuracy-retry" class="icon-btn" title="Retry" style="margin-left:8px;">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.13-.31 2.19-.85 3.09l1.46 1.46A7.932 7.932 0 0020 12c0-4.42-3.58-8-8-8z" fill="currentColor"/>
        <path d="M6.41 6.41A7.932 7.932 0 004 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3c-3.31 0-6-2.69-6-6 0-1.13.31-2.19.85-3.09l-1.46-1.46z" fill="currentColor"/>
      </svg>
    </button>
  </div>

  <!-- Floating Find My 6D Address Button (initial state) -->
  <button id="find-my-address-btn" class="floating-card floating-btn" type="button">Find My 6D Address</button>

  <!-- Floating Info Panel (hidden by default) -->
  <div id="info-panel" class="floating-card info-panel" style="display:none;">
    <div class="info-panel__actions">
      <button id="recenter-btn" class="icon-btn" title="Recenter">
        <!-- Recenter SVG (crosshair/target) -->
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <circle cx="12" cy="12" r="7" stroke="currentColor" stroke-width="2"/>
          <line x1="12" y1="3" x2="12" y2="7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="12" y1="17" x2="12" y2="21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="3" y1="12" x2="7" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="17" y1="12" x2="21" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <button id="copy-btn" class="icon-btn" title="Copy Address">
        <!-- Copy SVG -->
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2"/><rect x="2" y="2" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2"/></svg>
      </button>
      <button id="share-btn" class="icon-btn" title="Share">
        <!-- Share SVG -->
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><circle cx="18" cy="5" r="3" stroke="currentColor" stroke-width="2"/><circle cx="6" cy="12" r="3" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="19" r="3" stroke="currentColor" stroke-width="2"/><path d="M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
    </div>
    <div class="info-panel__code-plaque">
      <span id="code-part-1" class="code-part code-red">45</span>
      <span class="code-dash">-</span>
      <span id="code-part-2" class="code-part code-green">78</span>
      <span class="code-dash">-</span>
      <span id="code-part-3" class="code-part code-blue">12</span>
    </div>
    <div class="info-panel__district-region">
      <div id="district-name" class="info-panel__district">Shangaani</div>
      <div id="region-name" class="info-panel__region">Banaadir 03</div>
    </div>
    <button id="register-this-address-btn" class="floating-btn primary-btn" type="button">Register This Address</button>
  </div>

  <!-- Load Google Maps using the injected key from config.js -->
  <script type="module">
    import { GOOGLE_MAPS_API_KEY } from '/js/config.js';
    const s = document.createElement('script');
    s.src = `https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(GOOGLE_MAPS_API_KEY)}&libraries=geometry,places`;
    s.async = true;
    s.defer = true;
    document.head.appendChild(s);
  </script>

  <!-- App code (waits for Maps via waitForGoogleMaps) -->
  <script type="module" src="/js/somalia-map.js"></script>
</body>
</html>
